# [Installing ufw and SSH on Debian-based distros](https://www.cyberciti.biz/faq/how-to-install-ssh-on-ubuntu-linux-using-apt-get/)

Setup firewall (ufw) on both client and server
```bash
sudo apt install ufw
# allow port 22, otherwise SSH does not work
sudo ufw allow ssh
# check if open port 22 rule was successfully added
sudo ufw show added
# activate firewall, if and only if port 22 rule was allowed in previous command
sudo ufw enable
# check again if port 22 is open AND firewall is enabled
sudo ufw status
```

More about ssh and port 22 [here](https://www.cyberciti.biz/faq/ufw-allow-incoming-ssh-connections-from-a-specific-ip-address-subnet-on-ubuntu-debian/) and [here](https://www.cherryservers.com/blog/how-to-configure-ubuntu-firewall-with-ufw)

Setup client software
```bash
sudo apt install openssh-client
# access server
ssh userNameOnServer@ipAdressOfServer
```

Setup server software
```bash
# setup openssh-server (on server)
sudo apt install openssh-server
sudo systemctl enable ssh
```

How to Fix “Too many authentication failures” Error / override pubkey identification / force password usage
```bash
# if following command fails due to "Too many authentication failures"
ssh username@IpAddressOfServer
# force ssh to use password instead (=disable pubkey authentication)
ssh username@IpAdressOfServer -o PubkeyAuthentication=no
```

Setup pubkey on ssh server despite "Too many authentication failures" error

```bash
# keep the syntax, otherwise the pubkey copy process will fail
ssh-copy-id [-f] [-n] [-i identity file] [-p port] [-o ssh_option] [user@]hostname
ssh-copy-id -i /client/path/to/pubkeyFile -o PubkeyAuthentication=no username@IpAddressOfServer
```

[Understanding ssh-copy-id command-line options](https://www.ssh.com/academy/ssh/copy-id)


**Background:** Ssh client machine will try out all available private keys stored in .ssh folder to get access to ssh server. When all of them fail (for example more than 30 private keys were used) and the server only accepts a given amount of attempts (e.g. max 3 attempts), the server will return "Too many authentication failures" and close the connection immediately. If this happens, the ssh client will also be unable to use password login.


# [How to disable ssh password login on Linux to increase security](https://www.cyberciti.biz/faq/how-to-disable-ssh-password-login-on-linux/)

- [more on hardening ssh server](https://download.asperasoft.com/download/docs/client/3.5.2/client_admin_linux/webhelp/dita/ssh_server.html)

# Other issues
- [How to Fix “SSH Too Many Authentication Failures” Error](https://www.tecmint.com/fix-ssh-too-many-authentication-failures-error/)
- [How to recover from "Too many Authentication Failures for user root"](https://serverfault.com/questions/36291/how-to-recover-from-too-many-authentication-failures-for-user-root)
- [Only for background knowledge: Debian: How To Enable The Root User (Login & SSH)](https://raspberrytips.com/enable-root-debian/)
- [How to Enable and Disable Root User Account in Ubuntu](https://linuxize.com/post/how-to-enable-and-disable-root-user-account-in-ubuntu/)

Disable root account
```bash
$ sudo passwd -l root
```

Verify root account is disabled [(forum discussion)](https://ubuntuforums.org/archive/index.php/t-1884813.html)
```bash
$ sudo passwd -S root
# Expected output: "L" after root, then root is disabled
# Undesired output: if "P" after root, then root is enabled!!!
root L yyyy-mm-dd 99999 7 -1
```

# Setup wireguard

```bash
# import .conf file generated by FritzBox
nmcli connection import type wireguard file /path/to/wg_config.conf

# turn on/off wireguard connection
nmcli connection up wg_config
nmcli connection down wg_config

# disable autostart of wireguard VPN connection at startup
nmcli con mod wg_config connection.autoconnect no
```
- [Wireguard VPN unter Linux nutzen - Tutorial](https://www.youtube.com/watch?v=npDDELuiqxY)
- [How to stop wireguard vpn from auto connecting at startup?](https://www.reddit.com/r/kde/comments/17ud9kj/how_to_stop_wireguard_vpn_from_auto_connecting_at/)

# Setup Uni Bamberg VPN

- [VPN unter Linux - Mit Bordmitteln](https://www.uni-bamberg.de/its/dienstleistungen/netz/vpn/einrichten/linux/)
```bash
# setup VPN with the PDF provided by the link above
# turn on/off vpn connection with Uni Bamberg
nmcli connection up vpn_bamberg
nmcli connection down vpn_bamberg
